{{partial "hw-tk/dbg-template" .}}{{/*

childbar can be hidden with .Params.hide.childbar
.title is a string - default "this section"
.separator is a string - default "|"
.opts default is noSort + siblings
.opts is a string ascending|descending|parent|children
*/}}
{{ if not .Params.ui.hide.childbar}}
  {{$title := "this section:"}}
  {{with .Params.ui.childbar.title}}
    {{$title = .}}
  {{end}}
  {{$separator := "|"}}
  {{with .Params.ui.childbar.separator}}
    {{$separator = .}}
  {{end}}
  {{/* configure options for displaying the childbar */}}
  {{$opts := .Params.ui.childbar.opts}}
  {{$sortAscending := false}}
  {{$sortDescending := false}}
  {{$useParent := false}}
  {{$useChildren := false}}
  {{with $opts}}
    {{$sortAscending = strings.Contains $opts "ascending"}}
    {{$sortDescending = strings.Contains $opts "descending"}}
    {{$useParent = strings.Contains $opts "parent"}}
    {{$useChildren = strings.Contains $opts "children"}}
  {{end}}
  {{/* apply the options for displaying the childbar */}}
  {{$sep := printf "<span class=\"divider\">%s</span>" $separator|safeHTML}}
  {{/* use sibling pages */}}
  {{$childbarPages := .Pages}}
  {{- if $useParent}}{{$childbarPages = .Parent.Pages}}{{end -}}
  {{- if $useChildren}}{{$childbarPages = (index .Pages 0)}}{{end -}}

  {{- if (and $childbarPages $sortAscending)}}{{$childbarPages = $childbarPages.ByLinkTitle }}{{end -}}
  {{- if (and $childbarPages $sortDescending)}}{{$childbarPages = $childbarPages.ByLinkTitle.Reverse }}{{end -}}

  {{if gt ($childbarPages | len) 0}}
    <div class="childbar-horizontal">
      <small><em>{{$title}}</em></small>
      {{- if $useParent -}}
        {{$sep}} <strong><a href="{{ .Parent.RelPermalink }}">⬆️</a></strong>
      {{- end -}}
      {{ range  $childbarPages}}
        {{$sep}} <strong><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></strong>
      {{end}}
      {{$sep}}
    </div>
  {{end}}
{{end}}
