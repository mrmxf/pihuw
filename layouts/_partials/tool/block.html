{{partial "hw-tk/dbg-template" .}}
{{/*
 Hugo partial that renders responsive content blocks with media and text in configurable layouts
*/}}
{{/*

default block is 33%:66% that becomes full width at {{site.Params.resp.s}}
.srcWidth is ignored
.src
.srcOn "left"
+--srcGrid-+----txtGrid------------------------------------------+
| -------- | -----.header--------------------------------------- |
| -------- | -----.meta----------------------------------------- |
| -------- | -----.description----.inner------------------------ |
+----------+-----------------------------------------------------+
.srcOn "right"
+-----------------------------------------txtGrid-----+-srcGrid--+
| -----.header--------------------------------------- | -------- |
| -----.meta----------------------------------------- | -------- |
| -----.description----.inner------------------------ | -------- |
+-----------------------------------------------------+----------+

*/}}
{{$default := partial "hw-tk/get-defaults"}}
{{- $DBG := false -}}

{{with $DBG}}<p>
  <hr style="height:3px; border:none; color:rgb(60,90,180); background-color:rgb(60,255,180);">start tool/block
</p>{{end}}
{{/* ---handle src grid  ------------------------------------------------------------------------------------------ */}}
{{- $divClass := $default.class.block.divClass -}}
{{- $srcGrid :=  $default.class.block.srcGrid     -}}
{{- $txtGrid :=  $default.class.block.txtGrid     -}}
{{if .src}}
{{- $divClass = printf $default.class.block_m.divClass  site.Params.resp.m -}}
{{- $srcGrid =  printf $default.class.block_m.srcGrid   site.Params.resp.m -}}
{{- $txtGrid =  printf $default.class.block_m.txtGrid   site.Params.resp.m -}}
{{end}}
{{- with .class}}{{$divClass = .}}{{end}}
{{- with .srcGrid}}{{$srcGrid = .}}{{end}}
{{- with .txtGrid}}{{$txtGrid = .}}{{end}}
{{/* ---handle src type ------------------------------------------------------------------------------------------- */}}
{{- $ext := strings.ToLower (path.Ext .src) -}}
{{- $srcClass := printf $default.class.block.srcClass .srcClass -}}
{{- $srcIsVideo := in $default.slice.vid_ext $ext -}}
{{- $srcIsImage := in $default.slice.img_ext $ext -}}
{{- $mediaSrcClass := $default.class.block.imgClass -}}
{{with $srcIsVideo}}{{- $mediaSrcClass := $default.class.block.vidClass -}}{{end}}
{{/* squash any caption and identify media class */}}
{{- $mediaDot := merge . (dict "srcClass" $mediaSrcClass "text" nil) }}
{{/* --------------------------------------------------------------------- */}}
<div class = "{{$divClass}}">
{{if $DBG}}Source ({{.src}}) is on {{.srcOn}} @ srcGrid({{$srcGrid}}):txtGrid({{$txtGrid}}){{end}}
{{- if and .src (eq .srcOn "left") -}}
<div class="{{$srcGrid}}">{{ partial "tool/media" $mediaDot }}</div>
{{- end -}}
<div class="{{$txtGrid}}">
  <div class="card">
    {{- if .header -}}
    <header>
      {{if .headerLink}}<a href="{{.headerLink}}">{{.header}}</a>
      {{else}}{{ .header }}{{end}}
    </header>{{- end -}}
    {{- with .meta -}}
    <div class="meta"><span class="category">{{ . }}</span></div>
    {{- end -}}
    <div class="description">
      {{- .description | markdownify -}}
      {{- .inner | markdownify -}}
    </div>
  </div>
</div>
{{ if and .src (eq .srcOn "right") }}
<div class="{{$srcGrid}}">{{ partial "tool/media" $mediaDot }}</div>
{{end}}
{{with $DBG}}<p>END pihuw-block
  <hr class="block-hr">
</p>{{end}}
</div>